<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BLOG SENTINEL â€” AIë§ˆì¼€íŒ…ì „ëµì—°êµ¬ì†Œ</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&family=JetBrains+Mono:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#060912;
  --surface:#0c1220;
  --surface2:#101828;
  --border:rgba(0,210,255,0.1);
  --border2:rgba(0,210,255,0.06);
  --accent:#00d4ff;
  --accent2:#0066cc;
  --ok:#00e676;
  --warn:#ff4757;
  --text:#ddeeff;
  --muted:#4d6b8a;
  --gold:#f0c040;
  --card-glow-ok:rgba(0,230,118,0.06);
  --card-glow-warn:rgba(255,71,87,0.06);
}

*{margin:0;padding:0;box-sizing:border-box;}

body{
  background:var(--bg);
  color:var(--text);
  font-family:'Noto Sans KR',sans-serif;
  min-height:100vh;
  overflow-x:hidden;
}

/* â”€â”€ íŒŒí‹°í´ ìº”ë²„ìŠ¤ ë°°ê²½ â”€â”€ */
#bgCanvas{position:fixed;inset:0;z-index:0;pointer-events:none;opacity:0.55;}

/* â”€â”€ ìŠ¤ìº”ë¼ì¸ ì˜¤ë²„ë ˆì´ â”€â”€ */
body::after{
  content:'';
  position:fixed;inset:0;z-index:0;pointer-events:none;
  background:repeating-linear-gradient(0deg,transparent,transparent 2px,rgba(0,0,0,0.03) 2px,rgba(0,0,0,0.03) 4px);
}

.wrap{position:relative;z-index:1;max-width:1240px;margin:0 auto;padding:28px 20px;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
header{
  margin-bottom:32px;
  border-bottom:1px solid var(--border);
  padding-bottom:0;
}

.header-brand{
  text-align:center;
  padding:28px 0 20px;
  position:relative;
}
.header-brand::before{
  content:'';
  position:absolute;
  top:0;left:50%;transform:translateX(-50%);
  width:200px;height:1px;
  background:linear-gradient(90deg,transparent,var(--accent),transparent);
}
.brand-eyebrow{
  font-family:'JetBrains Mono',monospace;
  font-size:9px;letter-spacing:4px;
  color:var(--accent);opacity:0.7;
  text-transform:uppercase;
  margin-bottom:10px;
}
.brand-title{
  font-size:26px;font-weight:700;
  letter-spacing:-0.5px;
  line-height:1;
}
.brand-title .hl{
  color:var(--accent);
  text-shadow:0 0 20px rgba(0,212,255,0.5);
}
.brand-sub{
  font-family:'JetBrains Mono',monospace;
  font-size:9px;color:var(--muted);
  letter-spacing:2.5px;text-transform:uppercase;
  margin-top:8px;
}

.header-controls{
  display:grid;
  grid-template-columns:1fr auto 1fr;
  align-items:center;
  gap:16px;
  padding:14px 4px 20px;
}

/* ì‹œê³„ */
.hclock{}
.hclock-date{font-size:11px;color:var(--muted);letter-spacing:0.5px;margin-bottom:4px;}
.hclock-time{
  font-family:'JetBrains Mono',monospace;
  font-size:28px;font-weight:600;
  color:var(--accent);letter-spacing:3px;line-height:1;
  text-shadow:0 0 16px rgba(0,212,255,0.4);
}
.hclock-kst{font-size:9px;color:var(--muted);letter-spacing:2px;margin-top:4px;opacity:0.7;}

/* íƒ€ì´ë¨¸ (ê°€ìš´ë°) */
.htimer{
  background:rgba(0,212,255,0.04);
  border:1px solid var(--border);
  border-radius:14px;
  padding:12px 28px;
  text-align:center;
  backdrop-filter:blur(10px);
  position:relative;overflow:hidden;
}
.htimer::before{
  content:'';position:absolute;top:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,rgba(0,212,255,0.4),transparent);
}
.htimer-label{font-family:'JetBrains Mono',monospace;font-size:8px;letter-spacing:2.5px;color:var(--muted);text-transform:uppercase;margin-bottom:4px;}
.htimer-val{font-family:'JetBrains Mono',monospace;font-size:22px;font-weight:700;color:var(--accent);text-shadow:0 0 12px rgba(0,212,255,0.5);}
.hprogress{height:2px;background:rgba(0,212,255,0.1);border-radius:2px;overflow:hidden;margin-top:8px;}
.hprogress-fill{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));border-radius:2px;transition:width 1s linear;box-shadow:0 0 6px var(--accent);}

/* ë²„íŠ¼ */
.hbtns{display:flex;align-items:center;justify-content:flex-end;gap:10px;}

.btn-check{
  padding:10px 22px;
  background:linear-gradient(135deg,rgba(0,180,216,0.9),rgba(0,100,180,0.9));
  border:1px solid rgba(0,180,216,0.4);
  border-radius:10px;color:white;
  font-size:12px;font-family:'Noto Sans KR',sans-serif;font-weight:600;
  cursor:pointer;
  box-shadow:0 4px 20px rgba(0,180,216,0.2),inset 0 1px 0 rgba(255,255,255,0.1);
  transition:all 0.2s;white-space:nowrap;
  letter-spacing:0.3px;
}
.btn-check:hover{
  transform:translateY(-2px);
  box-shadow:0 8px 28px rgba(0,180,216,0.35),inset 0 1px 0 rgba(255,255,255,0.15);
}
.btn-check:disabled{opacity:0.4;cursor:not-allowed;transform:none;}

.btn-hide{
  padding:10px 16px;
  background:rgba(255,71,87,0.06);
  border:1px solid rgba(255,71,87,0.25);
  border-radius:10px;
  color:var(--warn);
  font-size:12px;font-family:'Noto Sans KR',sans-serif;font-weight:600;
  cursor:pointer;transition:all 0.2s;white-space:nowrap;
}
.btn-hide:not(.active){
  background:rgba(255,255,255,0.03);
  border-color:var(--border);
  color:var(--muted);
}
.btn-hide:hover{transform:translateY(-1px);}

/* HIDE ë§ˆìŠ¤í‚¹ */
.mask-real{display:inline;}
.mask-fake{
  display:none;font-family:'JetBrains Mono',monospace;
  color:transparent;background:rgba(77,107,138,0.35);
  border-radius:3px;padding:0 3px;user-select:none;
}
.hide-mode .mask-real{display:none !important;}
.hide-mode .mask-fake{display:inline !important;}
.hide-mode .sensitive-link{pointer-events:none;cursor:default;}
.post-title-link{color:var(--text);text-decoration:none;overflow:hidden;display:block;min-width:0;}
.post-title-link:hover{color:var(--accent);}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   SUMMARY CARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.summary{
  display:grid;grid-template-columns:repeat(4,1fr);
  gap:14px;margin-bottom:24px;
}

.sum-card{
  background:linear-gradient(145deg,var(--surface),var(--surface2));
  border:1px solid var(--border2);
  border-radius:14px;padding:18px 20px;
  position:relative;overflow:hidden;
  transition:transform 0.3s,box-shadow 0.3s;
  animation:fadeUp 0.5s ease both;
}
.sum-card:hover{transform:translateY(-2px);box-shadow:0 12px 32px rgba(0,0,0,0.3);}
.sum-card::before{content:'';position:absolute;top:0;left:0;right:0;height:1px;}
.sum-card::after{content:'';position:absolute;inset:0;border-radius:14px;background:linear-gradient(135deg,rgba(255,255,255,0.025),transparent);pointer-events:none;}
.sum-card.total::before{background:linear-gradient(90deg,var(--accent),transparent);}
.sum-card.ok::before{background:linear-gradient(90deg,var(--ok),transparent);}
.sum-card.warn::before{background:linear-gradient(90deg,var(--warn),transparent);}
.sum-card.today::before{background:linear-gradient(90deg,var(--gold),transparent);}

.sum-label{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--muted);text-transform:uppercase;letter-spacing:2px;font-weight:600;}
.sum-value{
  font-family:'JetBrains Mono',monospace;
  font-size:38px;font-weight:700;
  margin-top:8px;line-height:1;
  transition:all 0.4s;
}
.sum-card.total .sum-value{color:var(--accent);text-shadow:0 0 20px rgba(0,212,255,0.3);}
.sum-card.ok .sum-value{color:var(--ok);text-shadow:0 0 20px rgba(0,230,118,0.3);}
.sum-card.warn .sum-value{color:var(--warn);text-shadow:0 0 20px rgba(255,71,87,0.3);}
.sum-card.today .sum-value{color:var(--gold);text-shadow:0 0 20px rgba(240,192,64,0.3);}

@keyframes fadeUp{from{opacity:0;transform:translateY(16px);}to{opacity:1;transform:translateY(0);}}

.meta-row{
  display:flex;align-items:center;justify-content:space-between;
  flex-wrap:wrap;gap:10px;margin-bottom:24px;
}
.last-check{font-size:11px;color:var(--muted);}
.last-check .time{color:var(--accent);font-family:'JetBrains Mono',monospace;font-weight:600;}
.legend{display:flex;align-items:center;gap:12px;font-size:11px;flex-wrap:wrap;}
.legend span{display:flex;align-items:center;gap:5px;color:var(--muted);}
.dot{width:6px;height:6px;border-radius:50%;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   WEEKLY SECTION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.weekly-section{
  background:linear-gradient(145deg,var(--surface),var(--surface2));
  border:1px solid var(--border2);
  border-radius:16px;padding:22px;
  margin-bottom:24px;
  position:relative;overflow:hidden;
  animation:fadeUp 0.6s 0.1s ease both;
}
.weekly-section::before{
  content:'';position:absolute;top:0;left:0;right:0;height:1px;
  background:linear-gradient(90deg,transparent,var(--accent),transparent);
  opacity:0.3;
}

.section-title{
  font-size:12px;font-weight:700;color:var(--text);
  margin-bottom:18px;
  display:flex;align-items:center;gap:10px;
  letter-spacing:0.5px;
}
.section-title .icon{font-size:14px;}
.section-title::after{content:'';flex:1;height:1px;background:var(--border2);}

.weekly-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px;}
.weekly-row{
  background:rgba(0,0,0,0.25);
  border:1px solid var(--border2);
  border-radius:12px;padding:14px;
  transition:border-color 0.2s;
}
.weekly-row:hover{border-color:var(--border);}
.weekly-blog-name{display:flex;align-items:center;gap:8px;margin-bottom:14px;}
.weekly-id{font-family:'JetBrains Mono',monospace;font-size:12px;font-weight:600;color:var(--accent);}
.weekly-label{
  font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:700;
  color:var(--gold);background:rgba(240,192,64,0.08);
  padding:2px 8px;border-radius:4px;border:1px solid rgba(240,192,64,0.2);
}

.bars-wrap{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;align-items:end;height:48px;margin-bottom:6px;}
.bar-col{display:flex;flex-direction:column;align-items:center;justify-content:flex-end;height:100%;gap:2px;}
.bar-inner{
  width:100%;border-radius:3px 3px 0 0;min-height:3px;
  background:linear-gradient(180deg,rgba(0,212,255,0.4),rgba(0,212,255,0.15));
  border:1px solid rgba(0,212,255,0.3);
  transition:height 0.6s cubic-bezier(0.34,1.56,0.64,1);
}
.bar-inner.is-today{
  background:linear-gradient(180deg,rgba(0,230,118,0.5),rgba(0,230,118,0.2));
  border-color:rgba(0,230,118,0.5);
  box-shadow:0 -2px 8px rgba(0,230,118,0.2);
}
.bar-num{font-family:'JetBrains Mono',monospace;font-size:10px;color:var(--muted);font-weight:600;line-height:1;}
.bar-num.is-today{color:var(--ok);}
.dates-wrap{display:grid;grid-template-columns:repeat(7,1fr);gap:3px;}
.date-col{text-align:center;font-size:9px;color:var(--muted);line-height:1.6;}
.date-col.is-today{color:var(--ok);font-weight:700;}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   BLOG CARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.grid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;}

.card{
  background:linear-gradient(155deg,var(--surface) 0%,#0a1120 100%);
  border:1px solid var(--border2);
  border-radius:18px;padding:24px;
  position:relative;overflow:hidden;
  transition:transform 0.3s cubic-bezier(0.34,1.2,0.64,1),box-shadow 0.3s,border-color 0.3s;
  animation:fadeUp 0.5s ease both;
}
.card::before{
  content:'';position:absolute;
  top:-40%;left:-40%;width:80%;height:80%;
  background:radial-gradient(circle,rgba(0,212,255,0.04),transparent 70%);
  pointer-events:none;
}
.card::after{
  content:'';position:absolute;inset:0;border-radius:18px;
  background:linear-gradient(135deg,rgba(255,255,255,0.025) 0%,transparent 50%);
  pointer-events:none;
}
.card:hover{
  transform:translateY(-4px);
  box-shadow:0 20px 50px rgba(0,0,0,0.5);
  border-color:rgba(0,212,255,0.15);
}
.card.ok{border-left:2px solid var(--ok);}
.card.ok::before{background:radial-gradient(circle at 0 0,var(--card-glow-ok),transparent 60%);}
.card.warn{border-left:2px solid var(--warn);}
.card.warn::before{background:radial-gradient(circle at 0 0,var(--card-glow-warn),transparent 60%);}
@keyframes warnPulse{0%,100%{box-shadow:0 0 0 0 rgba(255,71,87,0);}50%{box-shadow:0 0 20px 4px rgba(255,71,87,0.06);}}
.card.warn{animation:warnPulse 2.5s ease-in-out infinite;}

/* ì¹´ë“œ í—¤ë” */
.card-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;}
.card-header-left{display:flex;align-items:center;gap:8px;}
.blog-num{
  font-family:'JetBrains Mono',monospace;font-size:9px;
  color:var(--muted);background:rgba(255,255,255,0.04);
  padding:3px 9px;border-radius:5px;
  border:1px solid var(--border2);letter-spacing:1px;
}
.blog-label-badge{
  font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:700;
  color:var(--gold);background:rgba(240,192,64,0.07);
  padding:3px 10px;border-radius:5px;
  border:1px solid rgba(240,192,64,0.18);
}
.badge{
  font-size:10px;font-weight:700;
  padding:5px 13px;border-radius:20px;
  white-space:nowrap;letter-spacing:0.5px;
  font-family:'JetBrains Mono',monospace;
}
.badge-ok{background:rgba(0,230,118,0.08);color:var(--ok);border:1px solid rgba(0,230,118,0.18);}
.badge-warn{
  background:rgba(255,71,87,0.08);color:var(--warn);
  border:1px solid rgba(255,71,87,0.18);
  animation:badgePulse 1.5s ease-in-out infinite;
}
.badge-loading{background:rgba(77,107,138,0.08);color:var(--muted);border:1px solid var(--border2);}
@keyframes badgePulse{0%,100%{opacity:1;}50%{opacity:0.5;}}

/* LIVE ë°” */
.live-bar{
  display:flex;align-items:center;gap:10px;
  margin-bottom:14px;
  padding:7px 12px;
  background:rgba(0,230,118,0.04);
  border:1px solid rgba(0,230,118,0.12);
  border-radius:8px;
}
.live-dot{
  width:7px;height:7px;border-radius:50%;
  background:#ff3b3b;flex-shrink:0;
  animation:livePulse 1.2s ease-in-out infinite;
}
@keyframes livePulse{
  0%,100%{box-shadow:0 0 0 0 rgba(255,59,59,0.7),0 0 6px rgba(255,59,59,0.8);}
  50%{box-shadow:0 0 0 5px rgba(255,59,59,0),0 0 10px rgba(255,59,59,0.3);}
}
.live-text{font-family:'JetBrains Mono',monospace;font-size:9px;font-weight:700;color:var(--ok);letter-spacing:2px;}
.live-sub{font-size:10px;color:var(--muted);margin-left:auto;}

/* ë¸”ë¡œê·¸ ID */
.blog-title-row{margin-bottom:4px;}
.blog-id{
  font-family:'JetBrains Mono',monospace;
  font-size:18px;font-weight:700;
  color:var(--accent);letter-spacing:0.5px;
  text-shadow:0 0 14px rgba(0,212,255,0.3);
}
.blog-url{
  font-size:11px;color:var(--muted);
  text-decoration:none;display:block;
  margin-bottom:16px;opacity:0.6;
  transition:opacity 0.2s,color 0.2s;
}
.blog-url:hover{opacity:1;color:var(--accent);}

/* ì˜¤ëŠ˜ ë°œí–‰ */
.today-box{
  display:flex;align-items:center;
  background:rgba(0,0,0,0.25);
  border:1px solid var(--border2);
  border-radius:12px;padding:14px 18px;
  margin-bottom:16px;
  position:relative;overflow:hidden;
}
.today-box::before{
  content:'';position:absolute;top:0;left:0;bottom:0;width:2px;
  background:linear-gradient(180deg,var(--ok),rgba(0,230,118,0.1));
}
.today-info{flex:1;padding-left:10px;}
.today-label{
  font-family:'JetBrains Mono',monospace;
  font-size:8px;color:var(--muted);
  text-transform:uppercase;letter-spacing:2px;font-weight:600;
}
.today-date{font-size:12px;color:var(--text);font-family:'JetBrains Mono',monospace;font-weight:600;margin-top:4px;}
.today-num{
  font-family:'JetBrains Mono',monospace;
  font-size:30px;font-weight:700;color:var(--ok);line-height:1;
  text-shadow:0 0 16px rgba(0,230,118,0.3);
}
.today-unit{font-size:11px;color:var(--muted);margin-left:2px;}

/* ê¸€ ëª©ë¡ */
.posts-table{
  background:rgba(0,0,0,0.2);
  border:1px solid var(--border2);
  border-radius:12px;overflow:hidden;
}
.posts-header{
  display:grid;grid-template-columns:1fr 104px;
  padding:9px 16px;
  background:rgba(0,212,255,0.03);
  border-bottom:1px solid var(--border2);
}
.posts-header span{
  font-family:'JetBrains Mono',monospace;
  font-size:8px;color:var(--muted);
  text-transform:uppercase;letter-spacing:2px;font-weight:600;
}
.post-row{
  display:grid;grid-template-columns:1fr 104px;
  padding:10px 16px;gap:8px;
  border-bottom:1px solid rgba(0,212,255,0.04);
  align-items:center;min-width:0;
  transition:background 0.15s;
}
.post-row:last-child{border-bottom:none;}
.post-row:hover{background:rgba(0,212,255,0.03);}
.post-row.hidden{display:none;}
.post-title{
  font-size:12px;color:#b8cede;
  display:block;overflow:hidden;
  text-overflow:ellipsis;white-space:nowrap;
  max-width:100%;line-height:1.4;
}
.post-time{
  font-size:11px;font-family:'JetBrains Mono',monospace;
  font-weight:600;text-align:right;white-space:nowrap;
}

/* ë” ë³´ê¸° */
.show-more-btn{
  width:100%;padding:10px;
  background:transparent;
  border:none;border-top:1px solid rgba(0,212,255,0.05);
  color:var(--muted);font-size:11px;
  font-family:'JetBrains Mono',monospace;
  cursor:pointer;transition:all 0.2s;
  letter-spacing:0.5px;
}
.show-more-btn:hover{background:rgba(0,212,255,0.03);color:var(--accent);}

.no-posts{font-size:12px;color:var(--warn);text-align:center;padding:22px 0;}
.no-posts small{color:var(--muted);display:block;margin-top:5px;font-size:11px;}

/* ìŠ¤ì¼ˆë ˆí†¤ */
.skeleton{display:flex;flex-direction:column;gap:8px;}
.skel-line{height:12px;background:var(--border2);border-radius:4px;animation:shimmer 1.8s infinite;}
@keyframes shimmer{
  0%{opacity:0.2;} 50%{opacity:0.5;} 100%{opacity:0.2;}
}

/* ëª¨ë°”ì¼ */
@media(max-width:720px){
  .grid{grid-template-columns:1fr;}
  .weekly-grid{grid-template-columns:repeat(2,1fr);}
  .summary{grid-template-columns:repeat(2,1fr);}
  .header-controls{grid-template-columns:1fr;gap:12px;}
  .hbtns{justify-content:center;}
  .hclock{text-align:center;}
  .htimer{width:100%;}
  .brand-title{font-size:20px;}
}
</style>
</head>
<body class="hide-mode">

<canvas id="bgCanvas"></canvas>

<div class="wrap">

  <!-- â•â• HEADER â•â• -->
  <header>
    <div class="header-brand">
      <div class="brand-eyebrow">AI-Powered Monitoring System</div>
      <h1 class="brand-title">ë„¤ì´ë²„ ìë™í™” ë¸”ë¡œê·¸ <span class="hl">ëª¨ë‹ˆí„°</span></h1>
      <div class="brand-sub">powered by AIë§ˆì¼€íŒ…ì „ëµì—°êµ¬ì†Œ Â· {{ warn_hours }}h threshold</div>
    </div>
    <div class="header-controls">
      <div class="hclock">
        <div class="hclock-date" id="clockDate">â€”</div>
        <div class="hclock-time" id="clockTime">00:00:00</div>
        <div class="hclock-kst">ğŸ‡°ğŸ‡· KOREA STANDARD TIME</div>
      </div>
      <div class="htimer">
        <div class="htimer-label">Next Refresh</div>
        <div class="htimer-val" id="countdown">30:00</div>
        <div class="hprogress"><div class="hprogress-fill" id="progressFill" style="width:100%"></div></div>
      </div>
      <div class="hbtns">
        <button id="hideBtn" class="btn-hide active" onclick="toggleHide()">ğŸ”’ HIDE ON</button>
        <button class="btn-check" id="checkBtn" onclick="checkAll()">âŸ³ ì§€ê¸ˆ í™•ì¸</button>
      </div>
    </div>
  </header>

  <!-- â•â• ìš”ì•½ â•â• -->
  <div class="summary">
    <div class="sum-card total" style="animation-delay:0s">
      <div class="sum-label">Monitoring</div>
      <div class="sum-value" id="totalCount">{{ blogs|length }}</div>
    </div>
    <div class="sum-card ok" style="animation-delay:0.05s">
      <div class="sum-label">âœ“ ì •ìƒ</div>
      <div class="sum-value" id="okCount">â€”</div>
    </div>
    <div class="sum-card warn" style="animation-delay:0.1s">
      <div class="sum-label">âš  ì´ìƒ</div>
      <div class="sum-value" id="warnCount">â€”</div>
    </div>
    <div class="sum-card today" style="animation-delay:0.15s">
      <div class="sum-label">ì˜¤ëŠ˜ ì´ ë°œí–‰</div>
      <div class="sum-value" id="todayTotal">â€”</div>
    </div>
  </div>

  <div class="meta-row">
    <div class="last-check">Last checked: <span class="time" id="lastCheck">â€”</span></div>
    <div class="legend">
      <span><span class="dot" style="background:#00e676;box-shadow:0 0 4px #00e676"></span>1hì´ë‚´</span>
      <span><span class="dot" style="background:#ffeb3b;box-shadow:0 0 4px #ffeb3b"></span>3hì´ë‚´</span>
      <span><span class="dot" style="background:#b0c8e0"></span>6hì´ë‚´</span>
      <span><span class="dot" style="background:#ff4757;box-shadow:0 0 4px #ff4757"></span>6hì´ˆê³¼</span>
    </div>
  </div>

  <!-- â•â• ì£¼ê°„ ë°œí–‰ í˜„í™© â•â• -->
  <div class="weekly-section">
    <div class="section-title"><span class="icon">ğŸ“Š</span> Weekly Performance</div>
    <div class="weekly-grid" id="weeklyGrid">
      {% for blog in blogs %}
      <div class="weekly-row" id="weekly-{{ loop.index0 }}">
        <div class="weekly-blog-name">
          <span class="weekly-id">
            <span class="mask-real">{{ blog.id }}</span>
            <span class="mask-fake">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>
          </span>
          {% if blog.label %}<span class="weekly-label">{{ blog.label }}</span>{% endif %}
        </div>
        <div class="skeleton">
          <div class="skel-line" style="width:100%;height:48px;"></div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>

  <!-- â•â• ë¸”ë¡œê·¸ ì¹´ë“œ â•â• -->
  <div class="grid" id="blogsGrid">
    {% for blog in blogs %}
    <div class="card loading" id="card-{{ loop.index0 }}" style="animation-delay:{{ loop.index0 * 0.07 }}s">
      <div class="card-header">
        <div class="card-header-left">
          <span class="blog-num">BLOG #{{ blog.num }}</span>
          {% if blog.label %}<span class="blog-label-badge">{{ blog.label }}</span>{% endif %}
        </div>
        <span class="badge badge-loading">â³ í™•ì¸ ì¤‘</span>
      </div>
      <div class="blog-title-row">
        <div class="blog-id">
          <span class="mask-real">{{ blog.id }}</span>
          <span class="mask-fake">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span>
        </div>
      </div>
      <a class="blog-url sensitive-link" href="https://blog.naver.com/{{ blog.id }}" target="_blank">
        <span class="mask-real">blog.naver.com/{{ blog.id }} â†—</span>
        <span class="mask-fake">blog.naver.com/â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â†—</span>
      </a>
      <div class="skeleton">
        <div class="skel-line" style="width:100%"></div>
        <div class="skel-line" style="width:75%"></div>
        <div class="skel-line" style="width:88%"></div>
      </div>
    </div>
    {% endfor %}
  </div>

</div><!-- /wrap -->

<script>
/* â”€â”€ íŒŒí‹°í´ ë°°ê²½ â”€â”€ */
(function(){
  const canvas=document.getElementById('bgCanvas');
  const ctx=canvas.getContext('2d');
  let W,H,particles=[];
  function resize(){
    W=canvas.width=window.innerWidth;
    H=canvas.height=window.innerHeight;
  }
  resize();
  window.addEventListener('resize',resize);
  function Particle(){
    this.x=Math.random()*W;
    this.y=Math.random()*H;
    this.vx=(Math.random()-0.5)*0.3;
    this.vy=(Math.random()-0.5)*0.3;
    this.r=Math.random()*1.5+0.5;
    this.a=Math.random()*0.5+0.1;
  }
  for(let i=0;i<90;i++)particles.push(new Particle());
  function draw(){
    ctx.clearRect(0,0,W,H);
    particles.forEach(p=>{
      p.x+=p.vx; p.y+=p.vy;
      if(p.x<0)p.x=W; if(p.x>W)p.x=0;
      if(p.y<0)p.y=H; if(p.y>H)p.y=0;
      ctx.beginPath();
      ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
      ctx.fillStyle=`rgba(0,212,255,${p.a})`;
      ctx.fill();
    });
    // ì—°ê²°ì„ 
    for(let i=0;i<particles.length;i++){
      for(let j=i+1;j<particles.length;j++){
        const dx=particles[i].x-particles[j].x;
        const dy=particles[i].y-particles[j].y;
        const dist=Math.sqrt(dx*dx+dy*dy);
        if(dist<120){
          ctx.beginPath();
          ctx.moveTo(particles[i].x,particles[i].y);
          ctx.lineTo(particles[j].x,particles[j].y);
          ctx.strokeStyle=`rgba(0,212,255,${0.07*(1-dist/120)})`;
          ctx.lineWidth=0.5;
          ctx.stroke();
        }
      }
    }
    requestAnimationFrame(draw);
  }
  draw();
})();

const WARN_HOURS={{ warn_hours }};
const DAYS=["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "];
let countdownSec=1800;
let timerInterval;

/* ì‹œê³„ */
function updateClock(){
  const now=new Date();
  const kst=new Date(now.getTime()+9*3600000);
  const h=String(kst.getUTCHours()).padStart(2,"0");
  const m=String(kst.getUTCMinutes()).padStart(2,"0");
  const s=String(kst.getUTCSeconds()).padStart(2,"0");
  document.getElementById("clockTime").textContent=`${h}:${m}:${s}`;
  const y=kst.getUTCFullYear(),mo=kst.getUTCMonth()+1,d=kst.getUTCDate(),dow=DAYS[kst.getUTCDay()];
  document.getElementById("clockDate").textContent=`${y}ë…„ ${mo}ì›” ${d}ì¼ (${dow})`;
}
setInterval(updateClock,1000);
updateClock();

/* HIDE í† ê¸€ */
function toggleHide(){
  const body=document.body;
  const btn=document.getElementById("hideBtn");
  if(body.classList.contains("hide-mode")){
    body.classList.remove("hide-mode");
    btn.textContent="ğŸ”“ HIDE OFF";
    btn.classList.remove("active");
  } else {
    body.classList.add("hide-mode");
    btn.textContent="ğŸ”’ HIDE ON";
    btn.classList.add("active");
  }
}

function timeColor(h){
  if(h>WARN_HOURS)return"#ff4757";
  if(h<=1)return"#00e676";
  if(h<=3)return"#ffeb3b";
  return"#b0c8e0";
}

function getTodayKST(){
  return new Date(new Date().getTime()+9*3600000).toISOString().slice(0,10);
}
function getTodayLabel(){
  const kst=new Date(new Date().getTime()+9*3600000);
  const m=kst.getUTCMonth()+1,d=kst.getUTCDate(),dow=DAYS[kst.getUTCDay()];
  return`${m}ì›” ${d}ì¼ (${dow})`;
}
function formatDate(dateStr){
  const d=new Date(dateStr+"T00:00:00+09:00");
  return{short:`${d.getMonth()+1}/${d.getDate()}`,dow:DAYS[d.getDay()]};
}

/* ì£¼ê°„ ì°¨íŠ¸ */
function renderWeekly(idx,blogId,label,history){
  const el=document.getElementById("weekly-"+idx);
  if(!el||!history)return;
  const today=getTodayKST();
  const maxCount=Math.max(...history.map(h=>h.count),1);
  const labelHtml=label?`<span class="weekly-label">${label}</span>`:"";
  const barsHtml=history.map(h=>{
    const isToday=h.date===today;
    const pct=Math.max((h.count/maxCount)*100,h.count>0?8:2);
    return`<div class="bar-col">
      <span class="bar-num${isToday?" is-today":""}">${h.count}</span>
      <div class="bar-inner${isToday?" is-today":""}" style="height:${pct}%"></div>
    </div>`;
  }).join("");
  const datesHtml=history.map(h=>{
    const isToday=h.date===today;
    const{short,dow}=formatDate(h.date);
    return`<div class="date-col${isToday?" is-today":""}">${short}<br>${dow}</div>`;
  }).join("");
  el.innerHTML=`
    <div class="weekly-blog-name">
      <span class="weekly-id"><span class="mask-real">${blogId}</span><span class="mask-fake">â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ</span></span>${labelHtml}
    </div>
    <div class="bars-wrap">${barsHtml}</div>
    <div class="dates-wrap">${datesHtml}</div>`;
}

/* ë” ë³´ê¸° */
function toggleMore(blogIdx){
  const card=document.getElementById("card-"+blogIdx);
  const hiddenRows=card.querySelectorAll(".post-row.hidden");
  const btn=card.querySelector(".show-more-btn");
  if(hiddenRows.length>0){
    hiddenRows.forEach(r=>r.classList.remove("hidden"));
    btn.textContent="â–² ì ‘ê¸°";
  } else {
    const allRows=card.querySelectorAll(".post-row");
    allRows.forEach((r,i)=>{if(i>=5)r.classList.add("hidden");});
    btn.textContent=`â–¼ MORE (${allRows.length-5})`;
  }
}

/* ì¹´ë“œ ë Œë” */
function renderCards(results){
  results.forEach((r,i)=>{
    const card=document.getElementById("card-"+i);
    if(!card)return;
    const isOk=r.ok&&r.posts?.length>0&&r.posts[0].hoursAgo<=WARN_HOURS;
    card.className="card "+(isOk?"ok":"warn");

    const labelBadge=r.label?`<span class="blog-label-badge">${r.label}</span>`:"";
    const maskedId="â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ";
    const titleMask="â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ";

    const todayHtml=`
      <div class="today-box">
        <div class="today-info">
          <div class="today-label">Today Published</div>
          <div class="today-date">${getTodayLabel()}</div>
        </div>
        <div><span class="today-num">${r.today_count||0}</span><span class="today-unit">ê°œ</span></div>
      </div>`;

    let postsHtml="";
    if(r.ok&&r.posts&&r.posts.length>0){
      const rowsHtml=r.posts.map((p,pi)=>`
        <div class="post-row${pi>=5?" hidden":""}">
          <a class="post-title-link sensitive-link" href="${p.link}" target="_blank">
            <span class="post-title"><span class="mask-real">${p.title}</span><span class="mask-fake">${titleMask}</span></span>
          </a>
          <span class="post-time" style="color:${timeColor(p.hoursAgo)}">${p.timeLabel}</span>
        </div>`).join("");
      const moreBtn=r.posts.length>5
        ?`<button class="show-more-btn" onclick="toggleMore(${i})">â–¼ MORE (${r.posts.length-5})</button>`:"";
      postsHtml=`
        <div class="posts-table">
          <div class="posts-header"><span>Post Title</span><span style="text-align:right">Written</span></div>
          ${rowsHtml}
        </div>${moreBtn}`;
    } else {
      postsHtml=`<div class="no-posts">âš  ìµœê·¼ ê¸€ì„ ì°¾ì„ ìˆ˜ ì—†ì–´ìš”<small>${r.error||"ë¸”ë¡œê·¸ IDë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”"}</small></div>`;
    }

    card.innerHTML=`
      <div class="card-header">
        <div class="card-header-left">
          <span class="blog-num">BLOG #${i+1}</span>${labelBadge}
        </div>
        <span class="badge ${isOk?"badge-ok":"badge-warn"}">${isOk?"âœ“ NORMAL":"âš  ALERT"}</span>
      </div>
      ${isOk?`<div class="live-bar">
        <span class="live-dot"></span>
        <span class="live-text">LIVE</span>
        <span class="live-sub">âœ AUTO WRITING</span>
      </div>`:""}
      <div class="blog-title-row">
        <div class="blog-id"><span class="mask-real">${r.blog_id}</span><span class="mask-fake">${maskedId}</span></div>
      </div>
      <a class="blog-url sensitive-link" href="https://blog.naver.com/${r.blog_id}" target="_blank">
        <span class="mask-real">blog.naver.com/${r.blog_id} â†—</span>
        <span class="mask-fake">blog.naver.com/${maskedId} â†—</span>
      </a>
      ${todayHtml}
      ${postsHtml}`;

    renderWeekly(i,r.blog_id,r.label,r.history);
  });
}

function checkAll(){
  const btn=document.getElementById("checkBtn");
  btn.disabled=true;btn.textContent="âŸ³ í™•ì¸ ì¤‘...";
  fetch("/api/check")
    .then(r=>r.json())
    .then(data=>{
      if(data.error){alert(data.error);return;}
      renderCards(data.results);
      document.getElementById("lastCheck").textContent=data.checked_at;
      const ok=data.results.filter(r=>r.ok&&r.posts?.[0]?.hoursAgo<=WARN_HOURS).length;
      document.getElementById("okCount").textContent=ok;
      document.getElementById("warnCount").textContent=data.results.length-ok;
      const todayTotal=data.results.reduce((sum,r)=>sum+(r.today_count||0),0);
      document.getElementById("todayTotal").textContent=todayTotal;
      resetCountdown();
    })
    .catch(e=>alert("ì„œë²„ ì˜¤ë¥˜: "+e))
    .finally(()=>{btn.disabled=false;btn.textContent="âŸ³ ì§€ê¸ˆ í™•ì¸";});
}

function resetCountdown(){
  countdownSec=1800;
  if(timerInterval)clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    countdownSec--;
    if(countdownSec<=0){checkAll();return;}
    const m=String(Math.floor(countdownSec/60)).padStart(2,"0");
    const s=String(countdownSec%60).padStart(2,"0");
    document.getElementById("countdown").textContent=m+":"+s;
    document.getElementById("progressFill").style.width=(countdownSec/1800*100)+"%";
  },1000);
}

window.onload=()=>checkAll();
</script>
</body>
</html>
